!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("@wonderlandlabs/propper")):"function"==typeof define&&define.amd?define(["@wonderlandlabs/propper"],r):(t=t||self).LGE=r(t.propper)}(this,(function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(t,e)};function e(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function n(t){return"function"==typeof t}var o=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;o=t},get useDeprecatedSynchronousErrorHandling(){return o}};function s(t){setTimeout((function(){throw t}),0)}var u={closed:!0,next:function(t){},error:function(t){if(i.useDeprecatedSynchronousErrorHandling)throw t;s(t)},complete:function(){}},a=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();var c=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,r){return r+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),h=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var r;if(!this.closed){var e,o=this._parentOrParents,i=this._unsubscribe,s=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,o instanceof t)o.remove(this);else if(null!==o)for(var u=0;u<o.length;++u){o[u].remove(this)}if(n(i))try{i.call(this)}catch(t){r=t instanceof c?l(t.errors):[t]}if(a(s)){u=-1;for(var h=s.length;++u<h;){var f=s[u];if(null!==(e=f)&&"object"==typeof e)try{f.unsubscribe()}catch(t){r=r||[],t instanceof c?r=r.concat(l(t.errors)):r.push(t)}}}if(r)throw new c(r)}},t.prototype.add=function(r){var e=r;if(!r)return t.EMPTY;switch(typeof r){case"function":e=new t(r);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof t)){var n=e;(e=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+r+" added next Subscription.")}var o=e._parentOrParents;if(null===o)e._parentOrParents=this;else if(o instanceof t){if(o===this)return e;e._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return e;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[e]:i.push(e),e},t.prototype.remove=function(t){var r=this._subscriptions;if(r){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function l(t){return t.reduce((function(t,r){return t.concat(r instanceof c?r.errors:r)}),[])}var f=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),p=function(t){function r(e,n,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=u;break;case 1:if(!e){i.destination=u;break}if("object"==typeof e){e instanceof r?(i.syncErrorThrowable=e.syncErrorThrowable,i.destination=e,e.add(i)):(i.syncErrorThrowable=!0,i.destination=new b(i,e));break}default:i.syncErrorThrowable=!0,i.destination=new b(i,e,n,o)}return i}return e(r,t),r.prototype[f]=function(){return this},r.create=function(t,e,n){var o=new r(t,e,n);return o.syncErrorThrowable=!1,o},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},r}(h),b=function(t){function r(r,e,o,i){var s,a=t.call(this)||this;a._parentSubscriber=r;var c=a;return n(e)?s=e:e&&(s=e.next,o=e.error,i=e.complete,e!==u&&(n((c=Object.create(e)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(a))),a._context=c,a._next=s,a._error=o,a._complete=i,a}return e(r,t),r.prototype.next=function(t){if(!this.isStopped&&this._next){var r=this._parentSubscriber;i.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable?this.__tryOrSetError(r,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},r.prototype.error=function(t){if(!this.isStopped){var r=this._parentSubscriber,e=i.useDeprecatedSynchronousErrorHandling;if(this._error)e&&r.syncErrorThrowable?(this.__tryOrSetError(r,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(r.syncErrorThrowable)e?(r.syncErrorValue=t,r.syncErrorThrown=!0):s(t),this.unsubscribe();else{if(this.unsubscribe(),e)throw t;s(t)}}},r.prototype.complete=function(){var t=this;if(!this.isStopped){var r=this._parentSubscriber;if(this._complete){var e=function(){return t._complete.call(t._context)};i.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable?(this.__tryOrSetError(r,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}},r.prototype.__tryOrUnsub=function(t,r){try{t.call(this._context,r)}catch(t){if(this.unsubscribe(),i.useDeprecatedSynchronousErrorHandling)throw t;s(t)}},r.prototype.__tryOrSetError=function(t,r,e){if(!i.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{r.call(this._context,e)}catch(r){return i.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(s(r),!0)}return!1},r.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},r}(p);var d=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function y(t){return t}function v(t){return 0===t.length?y:1===t.length?t[0]:function(r){return t.reduce((function(t,r){return r(t)}),r)}}var _=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(r){var e=new t;return e.source=this,e.operator=r,e},t.prototype.subscribe=function(t,r,e){var n=this.operator,o=function(t,r,e){if(t){if(t instanceof p)return t;if(t[f])return t[f]()}return t||r||e?new p(t,r,e):new p(u)}(t,r,e);if(n?o.add(n.call(o,this.source)):o.add(this.source||i.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),i.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){i.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=r),!function(t){for(;t;){var r=t,e=r.closed,n=r.destination,o=r.isStopped;if(e||o)return!1;t=n&&n instanceof p?n:null}return!0}(t)?console.warn(r):t.error(r)}},t.prototype.forEach=function(t,r){var e=this;return new(r=g(r))((function(r,n){var o;o=e.subscribe((function(r){try{t(r)}catch(t){n(t),o&&o.unsubscribe()}}),n,r)}))},t.prototype._subscribe=function(t){var r=this.source;return r&&r.subscribe(t)},t.prototype[d]=function(){return this},t.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return 0===t.length?this:v(t)(this)},t.prototype.toPromise=function(t){var r=this;return new(t=g(t))((function(t,e){var n;r.subscribe((function(t){return n=t}),(function(t){return e(t)}),(function(){return t(n)}))}))},t.create=function(r){return new t(r)},t}();function g(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}var m=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),w=function(t){function r(r,e){var n=t.call(this)||this;return n.subject=r,n.subscriber=e,n.closed=!1,n}return e(r,t),r.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,r=t.observers;if(this.subject=null,r&&0!==r.length&&!t.isStopped&&!t.closed){var e=r.indexOf(this.subscriber);-1!==e&&r.splice(e,1)}}},r}(h),S=function(t){function r(r){var e=t.call(this,r)||this;return e.destination=r,e}return e(r,t),r}(p),E=function(t){function r(){var r=t.call(this)||this;return r.observers=[],r.closed=!1,r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return e(r,t),r.prototype[f]=function(){return new S(this)},r.prototype.lift=function(t){var r=new j(this,this);return r.operator=t,r},r.prototype.next=function(t){if(this.closed)throw new m;if(!this.isStopped)for(var r=this.observers,e=r.length,n=r.slice(),o=0;o<e;o++)n[o].next(t)},r.prototype.error=function(t){if(this.closed)throw new m;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var r=this.observers,e=r.length,n=r.slice(),o=0;o<e;o++)n[o].error(t);this.observers.length=0},r.prototype.complete=function(){if(this.closed)throw new m;this.isStopped=!0;for(var t=this.observers,r=t.length,e=t.slice(),n=0;n<r;n++)e[n].complete();this.observers.length=0},r.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},r.prototype._trySubscribe=function(r){if(this.closed)throw new m;return t.prototype._trySubscribe.call(this,r)},r.prototype._subscribe=function(t){if(this.closed)throw new m;return this.hasError?(t.error(this.thrownError),h.EMPTY):this.isStopped?(t.complete(),h.EMPTY):(this.observers.push(t),new w(this,t))},r.prototype.asObservable=function(){var t=new _;return t.source=this,t},r.create=function(t,r){return new j(t,r)},r}(_),j=function(t){function r(r,e){var n=t.call(this)||this;return n.destination=r,n.source=e,n}return e(r,t),r.prototype.next=function(t){var r=this.destination;r&&r.next&&r.next(t)},r.prototype.error=function(t){var r=this.destination;r&&r.error&&this.destination.error(t)},r.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},r.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):h.EMPTY},r}(E),O=function(t){function r(r){var e=t.call(this)||this;return e._value=r,e}return e(r,t),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(r){var e=t.prototype._subscribe.call(this,r);return e&&!e.closed&&r.next(this._value),e},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new m;return this._value},r.prototype.next=function(r){t.prototype.next.call(this,this._value=r)},r}(E);var T=function(){function t(){}return t.prototype.call=function(t,r){return r.subscribe(new x(t))},t}(),x=function(t){function r(r){var e=t.call(this,r)||this;return e.hasPrev=!1,e}return e(r,t),r.prototype._next=function(t){var r;this.hasPrev?r=[this.prev,t]:this.hasPrev=!0,this.prev=t,r&&this.destination.next(r)},r}(p);var P,$,A=function(t){return t},N=Object.prototype,z=N.hasOwnProperty,k=N.toString;
/**!
     * is
     * the definitive JavaScript type testing library
     *
     * @copyright 2013-2014 Enrico Marino / Jordan Harband
     * @license MIT
     */"function"==typeof Symbol&&(P=Symbol.prototype.valueOf),"function"==typeof BigInt&&($=BigInt.prototype.valueOf);var q=function(t){return t!=t},D={boolean:1,number:1,string:1,undefined:1},F=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/,H=/^[A-Fa-f0-9]+$/,C={};C.a=C.type=function(t,r){return typeof t===r},C.defined=function(t){return void 0!==t},C.empty=function(t){var r,e=k.call(t);if("[object Array]"===e||"[object Arguments]"===e||"[object String]"===e)return 0===t.length;if("[object Object]"===e){for(r in t)if(z.call(t,r))return!1;return!0}return!t},C.equal=function(t,r){if(t===r)return!0;var e,n=k.call(t);if(n!==k.call(r))return!1;if("[object Object]"===n){for(e in t)if(!(C.equal(t[e],r[e])&&e in r))return!1;for(e in r)if(!(C.equal(t[e],r[e])&&e in t))return!1;return!0}if("[object Array]"===n){if((e=t.length)!==r.length)return!1;for(;e--;)if(!C.equal(t[e],r[e]))return!1;return!0}return"[object Function]"===n?t.prototype===r.prototype:"[object Date]"===n&&t.getTime()===r.getTime()},C.hosted=function(t,r){var e=typeof r[t];return"object"===e?!!r[t]:!D[e]},C.instance=C.instanceof=function(t,r){return t instanceof r},C.nil=C.null=function(t){return null===t},C.undef=C.undefined=function(t){return void 0===t},C.args=C.arguments=function(t){var r="[object Arguments]"===k.call(t),e=!C.array(t)&&C.arraylike(t)&&C.object(t)&&C.fn(t.callee);return r||e},C.array=Array.isArray||function(t){return"[object Array]"===k.call(t)},C.args.empty=function(t){return C.args(t)&&0===t.length},C.array.empty=function(t){return C.array(t)&&0===t.length},C.arraylike=function(t){return!!t&&!C.bool(t)&&z.call(t,"length")&&isFinite(t.length)&&C.number(t.length)&&t.length>=0},C.bool=C.boolean=function(t){return"[object Boolean]"===k.call(t)},C.false=function(t){return C.bool(t)&&!1===Boolean(Number(t))},C.true=function(t){return C.bool(t)&&!0===Boolean(Number(t))},C.date=function(t){return"[object Date]"===k.call(t)},C.date.valid=function(t){return C.date(t)&&!isNaN(Number(t))},C.element=function(t){return void 0!==t&&"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&1===t.nodeType},C.error=function(t){return"[object Error]"===k.call(t)},C.fn=C.function=function(t){if("undefined"!=typeof window&&t===window.alert)return!0;var r=k.call(t);return"[object Function]"===r||"[object GeneratorFunction]"===r||"[object AsyncFunction]"===r},C.number=function(t){return"[object Number]"===k.call(t)},C.infinite=function(t){return t===1/0||t===-1/0},C.decimal=function(t){return C.number(t)&&!q(t)&&!C.infinite(t)&&t%1!=0},C.divisibleBy=function(t,r){var e=C.infinite(t),n=C.infinite(r),o=C.number(t)&&!q(t)&&C.number(r)&&!q(r)&&0!==r;return e||n||o&&t%r==0},C.integer=C.int=function(t){return C.number(t)&&!q(t)&&t%1==0},C.maximum=function(t,r){if(q(t))throw new TypeError("NaN is not a valid value");if(!C.arraylike(r))throw new TypeError("second argument must be array-like");for(var e=r.length;--e>=0;)if(t<r[e])return!1;return!0},C.minimum=function(t,r){if(q(t))throw new TypeError("NaN is not a valid value");if(!C.arraylike(r))throw new TypeError("second argument must be array-like");for(var e=r.length;--e>=0;)if(t>r[e])return!1;return!0},C.nan=function(t){return!C.number(t)||t!=t},C.even=function(t){return C.infinite(t)||C.number(t)&&t==t&&t%2==0},C.odd=function(t){return C.infinite(t)||C.number(t)&&t==t&&t%2!=0},C.ge=function(t,r){if(q(t)||q(r))throw new TypeError("NaN is not a valid value");return!C.infinite(t)&&!C.infinite(r)&&t>=r},C.gt=function(t,r){if(q(t)||q(r))throw new TypeError("NaN is not a valid value");return!C.infinite(t)&&!C.infinite(r)&&t>r},C.le=function(t,r){if(q(t)||q(r))throw new TypeError("NaN is not a valid value");return!C.infinite(t)&&!C.infinite(r)&&t<=r},C.lt=function(t,r){if(q(t)||q(r))throw new TypeError("NaN is not a valid value");return!C.infinite(t)&&!C.infinite(r)&&t<r},C.within=function(t,r,e){if(q(t)||q(r)||q(e))throw new TypeError("NaN is not a valid value");if(!C.number(t)||!C.number(r)||!C.number(e))throw new TypeError("all arguments must be numbers");return C.infinite(t)||C.infinite(r)||C.infinite(e)||t>=r&&t<=e},C.object=function(t){return"[object Object]"===k.call(t)},C.primitive=function(t){return!t||!("object"==typeof t||C.object(t)||C.fn(t)||C.array(t))},C.hash=function(t){return C.object(t)&&t.constructor===Object&&!t.nodeType&&!t.setInterval},C.regexp=function(t){return"[object RegExp]"===k.call(t)},C.string=function(t){return"[object String]"===k.call(t)},C.base64=function(t){return C.string(t)&&(!t.length||F.test(t))},C.hex=function(t){return C.string(t)&&(!t.length||H.test(t))},C.symbol=function(t){return"function"==typeof Symbol&&"[object Symbol]"===k.call(t)&&"symbol"==typeof P.call(t)},C.bigint=function(t){return"function"==typeof BigInt&&"[object BigInt]"===k.call(t)&&"bigint"==typeof $.call(t)};var M=C;const V=Symbol("ABSENT"),B=t=>t&&t!==V,I=t=>t!==V&&void 0!==t,U=t=>t!==V,R=t=>t===V;var Y=Array.isArray,Z="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},G="object"==typeof Z&&Z&&Z.Object===Object&&Z,L="object"==typeof self&&self&&self.Object===Object&&self,J=G||L||Function("return this")(),K=J.Symbol,Q=Object.prototype,W=Q.hasOwnProperty,X=Q.toString,tt=K?K.toStringTag:void 0;var rt=function(t){var r=W.call(t,tt),e=t[tt];try{t[tt]=void 0;var n=!0}catch(t){}var o=X.call(t);return n&&(r?t[tt]=e:delete t[tt]),o},et=Object.prototype.toString;var nt=function(t){return et.call(t)},ot="[object Null]",it="[object Undefined]",st=K?K.toStringTag:void 0;var ut=function(t){return null==t?void 0===t?it:ot:st&&st in Object(t)?rt(t):nt(t)};var at=function(t){return null!=t&&"object"==typeof t};var ct=function(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)},ht="[object AsyncFunction]",lt="[object Function]",ft="[object GeneratorFunction]",pt="[object Proxy]";var bt,dt=function(t){if(!ct(t))return!1;var r=ut(t);return r==lt||r==ft||r==ht||r==pt},yt=J["__core-js_shared__"],vt=(bt=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||""))?"Symbol(src)_1."+bt:"";var _t=function(t){return!!vt&&vt in t},gt=Function.prototype.toString;var mt=function(t){if(null!=t){try{return gt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},wt=/^\[object .+?Constructor\]$/,St=Function.prototype,Et=Object.prototype,jt=St.toString,Ot=Et.hasOwnProperty,Tt=RegExp("^"+jt.call(Ot).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var xt=function(t){return!(!ct(t)||_t(t))&&(dt(t)?Tt:wt).test(mt(t))};var Pt=function(t,r){return null==t?void 0:t[r]};var $t=function(t,r){var e=Pt(t,r);return xt(e)?e:void 0},At=$t(Object,"create");var Nt=function(){this.__data__=At?At(null):{},this.size=0};var zt=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},kt="__lodash_hash_undefined__",qt=Object.prototype.hasOwnProperty;var Dt=function(t){var r=this.__data__;if(At){var e=r[t];return e===kt?void 0:e}return qt.call(r,t)?r[t]:void 0},Ft=Object.prototype.hasOwnProperty;var Ht=function(t){var r=this.__data__;return At?void 0!==r[t]:Ft.call(r,t)},Ct="__lodash_hash_undefined__";var Mt=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=At&&void 0===r?Ct:r,this};function Vt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Vt.prototype.clear=Nt,Vt.prototype.delete=zt,Vt.prototype.get=Dt,Vt.prototype.has=Ht,Vt.prototype.set=Mt;var Bt=Vt;var It=function(){this.__data__=[],this.size=0};var Ut=function(t,r){return t===r||t!=t&&r!=r};var Rt=function(t,r){for(var e=t.length;e--;)if(Ut(t[e][0],r))return e;return-1},Yt=Array.prototype.splice;var Zt=function(t){var r=this.__data__,e=Rt(r,t);return!(e<0)&&(e==r.length-1?r.pop():Yt.call(r,e,1),--this.size,!0)};var Gt=function(t){var r=this.__data__,e=Rt(r,t);return e<0?void 0:r[e][1]};var Lt=function(t){return Rt(this.__data__,t)>-1};var Jt=function(t,r){var e=this.__data__,n=Rt(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};function Kt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Kt.prototype.clear=It,Kt.prototype.delete=Zt,Kt.prototype.get=Gt,Kt.prototype.has=Lt,Kt.prototype.set=Jt;var Qt=Kt,Wt=$t(J,"Map");var Xt=function(){this.size=0,this.__data__={hash:new Bt,map:new(Wt||Qt),string:new Bt}};var tr=function(t){var r=typeof t;return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t};var rr=function(t,r){var e=t.__data__;return tr(r)?e["string"==typeof r?"string":"hash"]:e.map};var er=function(t){var r=rr(this,t).delete(t);return this.size-=r?1:0,r};var nr=function(t){return rr(this,t).get(t)};var or=function(t){return rr(this,t).has(t)};var ir=function(t,r){var e=rr(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function sr(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}sr.prototype.clear=Xt,sr.prototype.delete=er,sr.prototype.get=nr,sr.prototype.has=or,sr.prototype.set=ir;var ur=sr,ar="Expected a function";function cr(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError(ar);var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return e.cache=i.set(o,s)||i,s};return e.cache=new(cr.Cache||ur),e}cr.Cache=ur;var hr=cr,lr=500;var fr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pr=/\\(\\)?/g,br=(function(t){var r=hr(t,(function(t){return e.size===lr&&e.clear(),t})),e=r.cache}((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(fr,(function(t,e,n,o){r.push(n?o.replace(pr,"$1"):e||t)})),r})),K?K.prototype:void 0);br&&br.toString;class dr{constructor(t,r=V){this.value=t,I(r)&&("string"==typeof r.name&&(this.name=r.name),this.trans=!!r.trans,this.prev=r.prev,this.error=r.error,this.target=r.target)}endTrans(){this.target?this.target.endTrans(this):console.log("message has no target: ,",this)}}t.proppify(dr).addProp("target",null).addProp("name","").addProp("value",null).addProp("complete",!1).addProp("prev",V).addProp("trans",!1,"boolean").addProp("error",null);var yr=function(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t},vr="[object Arguments]";var _r=function(t){return at(t)&&ut(t)==vr},gr=Object.prototype,mr=gr.hasOwnProperty,wr=gr.propertyIsEnumerable,Sr=_r(function(){return arguments}())?_r:function(t){return at(t)&&mr.call(t,"callee")&&!wr.call(t,"callee")},Er=K?K.isConcatSpreadable:void 0;var jr=function(t){return Y(t)||Sr(t)||!!(Er&&t&&t[Er])};var Or=function t(r,e,n,o,i){var s=-1,u=r.length;for(n||(n=jr),i||(i=[]);++s<u;){var a=r[s];e>0&&n(a)?e>1?t(a,e-1,n,o,i):yr(i,a):o||(i[i.length]=a)}return i},Tr=1/0;var xr=function(t){return(null==t?0:t.length)?Or(t,Tr):[]};function Pr(t,r="invalid ValueStream name"){if(!t||!I(t)||!M.string(t)&&!M.number(t)){const e=new Error(r);throw U(t)?e.name=t:e.name=void 0,e}}class $r{constructor(t=V,r=V,e=V){this.name=t,U(r)&&(this.value=r),B(e)&&(this.filter=e)}get name(){return this._name}set name(t){Pr(t,"cannot initialize ValueStream with bad name"),this._name=t}hasValidName(){try{return Pr(this.name),!0}catch(t){return!1}}get value(){return this._value}set value(t){let r=this.validate(t,!0);if(r){Array.isArray(r)&&(r=r.join(", "));const t=new Error(`attempt to set ${this.name}to bad value`);throw t.errors=r,t}this._value=t}validate(t=V,r=!1){if(R(t))return R(this.value)?null:this.validate(this.value);try{if(!B(this.filter)||R(t))return!1;const e=xr([this.filter]).reduce((r,e)=>{const n=this._filterFor(e,t,r);return n?[...r,n]:r},[]);if(!r)return e;if(!e.length)return!1;if(1===e.length)return e.pop()}catch(t){console.log("error validating type:",t)}return!1}_filterFor(t,r,e){return M.function(t)?t(r,e,this):M[t]?!M[t](r)&&`${this.name} must be a ${t}`:`cannot parse type ${t}`}}t.proppify($r).addProp("filter",V);class Ar extends $r{constructor(t=V,r=V,e=V){super(t,r,e)}get $changes(){return this._changes||(this._changes=new E),this._changes}to(t=V,r=V){const e=this.makeMessage(t,r);return this._$requests.next(e),e}makeMessage(t,r=V){const e=U(r)&&M.object(r)?r:{};return new dr(t,{...e,name:this.name,target:this})}get _$requests(){return this.__requests||(this.__requests=new E,this.subSet.add(this.__requests.subscribe(this._onRequest.bind(this),t=>{console.log("request submission error:",t)}))),this.__requests}_onRequest(t){if(t.complete)console.log("attempt next re-process a complete message",t);else if(t.prev=this.value,!R(t.value)){try{this.value=t.value}catch({message:r,errors:e}){t.error=e||r,this.errors.next(t)}t.error||(this.$changes.next(t),this.hasTranses?this.pendingChanges=!0:this._broadcastChange(t))}}_broadcastChange(t){this._$updater.next(t)}get errors(){return this._errors||(this._errors=new E),this._errors}get hasTranses(){return!!this._transes}get _$transes(){return this.hasTranses||(this._transes=new Set),this._transes}startTrans(){const t=this.makeMessage(V,{trans:!0});return this._$transes.add(t),this._broadcastTrans(),t}endTrans(t){this._$transes.has(t)&&(this._$transes.delete(t),this._broadcastTrans())}_broadcastTrans(){this._$transStream.next(this._$transes.size)}get _$transStream(){return this.__transStream||(this.__transStream=new O(this._$transes.size),this.subSet.add(this.__transStream.pipe((function(t){return t.lift(new T)})).subscribe(([t,r])=>{this.pendingChanges&&t&&!r&&(this.pendingChanges=!1,this._broadcastChange())}))),this.__transStream}get _$updater(){return this.__updater||(this.__updater=new O(this)),this.__updater}subscribe(t=A,r=A,e=A){r&&this.subSet.add(this.errors.subscribe(r,r));const n=this._$updater.subscribe(()=>{t(this)},r,e);return this.subSet.add(n),n}complete(){try{Array.from(this.subSet).forEach(t=>{t.unsubscribe(),this.subSet.delete(t)})}catch(t){console.log("complete error: ",t)}}}return t.proppify(Ar).addProp("filter",V).addProp("validator",V).addProp("pendingChanges",!1,"boolean").addProp("subSet",()=>new Set),{ValueStream:Ar}}));
